# ルールベース改善後の検出結果レポート

## 改善内容
追加ライブラリ（OCR等）を使用せず、以下のフィルタリング条件を厳格化しました：
1. **最小サイズ**: 画像短辺の10%以上（約200px）
2. **最小面積**: 画像全体の1%以上
3. **アスペクト比**: 8以下

## 検出結果比較

| ファイル名 | 正解数 | 改善前 (個) | **改善後 (個)** | 評価 |
|------------|--------|------------|----------------|------|
| パンターG型_001.jpg | 2 | 3 | **2** | ✅ **完全一致** |
| パンターG型_002.jpg | 2 | 3 | **3** | 惜しい（+1） |
| パンターG型_003.jpg | 3 | 4 | **4** | 惜しい（+1） |
| パンターG型_004.jpg | 2 | 4 | **3** | 改善（+1） |
| パンターG型_005.jpg | 6 | 12 | **5** | **大幅改善**（ただし1つ見逃し） |

## 考察
- **誤検出の大幅削減**: 特に `パンターG型_005.jpg` で顕著な改善が見られました（12個→5個）。ノイズとなっていた小さな領域が除去されました。
- **検出漏れのリスク**: フィルタを厳しくしたことで、`パンターG型_005.jpg` で1つの正解領域が見逃されました。これはトレードオフですが、実運用では「多すぎる誤検出」より「少数の見逃し（手動追加可能）」の方が扱いやすい場合があります。
- **実用性**: 追加の重いライブラリなしで、OpenCVのみでここまで精度を向上できたのは大きな成果です。

## 今後の推奨
このロジックをベースに、管理画面（Streamlit）に組み込むことを推奨します。
管理画面では以下のフローになります：
1. 自動検出実行（今回のロジック）
2. 検出結果（枠）を表示
3. ユーザーが「不足している枠を追加」または「余分な枠を削除」して保存

これにより、100%の精度でなくても業務利用が可能になります。
